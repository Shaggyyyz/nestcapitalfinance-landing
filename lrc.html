<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Loan Repayment Calculator - Nest Capital Finance</title>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@300;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Fira Sans', Arial, sans-serif;
      font-weight: 300;
      background: #181820;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      max-width: 1200px;
      margin: 3.5rem auto 2rem auto;
      background: none;
      justify-content: center;
    }
    .calculator, .results {
      background: #fff;
      color: #181820;
      border-radius: 14px;
      box-shadow: 0 1px 12px #0405123a;
      padding: 2rem 2.5rem;
      min-width: 340px;
      max-width: 420px;
      flex: 1 1 350px;
    }
    @media (max-width: 900px) {
      .container {
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }
      .calculator, .results {
        max-width: 97vw;
        min-width: unset;
        padding: 1.3rem 1rem;
      }
    }
    h1, h2 {
      margin-top: 0;
      text-align: left;
      font-weight: 700;
      color: #181820;
    }
    h2 {
      font-size: 1.7rem;
      margin-bottom: 1.2rem;
    }
    .tab-group {
      display: flex;
      gap: 0.3rem;
      margin-bottom: 1rem;
    }
    .tab-btn {
      flex: 1;
      padding: 0.7rem 0.2rem;
      border: 2px solid #181820;
      background: #fff;
      color: #181820;
      font-weight: 700;
      border-radius: 6px;
      cursor: pointer;
      transition: background .16s, color .16s;
    }
    .tab-btn.active {
      background: #181820;
      color: #fff;
    }
    .form-group {
      margin-bottom: 1.2rem;
    }
    .form-label {
      font-size: 1.02rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      display: block;
      color: #232330;
    }
    .form-row {
      display: flex;
      gap: 1.2rem;
    }
    input[type="text"], input[type="tel"], input[type="number"], input[type="email"], select {
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 7px;
      border: 1px solid #34344e;
      background: #ececf5;
      color: #181820;
      font-size: 1rem;
      font-family: inherit;
      font-weight: 400;
      outline: none;
      margin-bottom: 0.4rem;
      transition: border 0.16s;
      box-sizing: border-box;
    }
    input:focus, select:focus {
      border: 1.6px solid #2563eb;
      background: #fff;
    }
    .radio-group {
      display: flex;
      gap: 1rem;
      margin-bottom: 0.4rem;
    }
    .radio-btn {
      background: #ececf5;
      border: 2px solid #232330;
      border-radius: 7px;
      color: #181820;
      padding: 0.6rem 1.3rem;
      font-weight: 700;
      font-size: 1.03rem;
      cursor: pointer;
      margin-right: .6rem;
      transition: background .15s, color .15s, border .1s;
    }
    .radio-btn.active {
      background: #2563eb;
      color: #fff;
      border-color: #2563eb;
    }
    .results {
      background: #f5f6fb;
      color: #181820;
      min-width: 320px;
    }
    .result-title {
      font-size: 1.25rem;
      margin-bottom: 0.7rem;
      font-weight: 700;
      color: #181820;
    }
    .result-main {
      font-size: 2.3rem;
      font-weight: 700;
      color: #232330;
      margin-bottom: 1.3rem;
    }
    .result-row {
      display: flex;
      justify-content: space-between;
      font-size: 1.12rem;
      margin-bottom: .4rem;
    }
    .result-label {
      color: #34344e;
    }
    .result-value {
      font-weight: 700;
    }
    .total-amount {
      font-size: 1.4rem;
      font-weight: 700;
      color: #2563eb;
      margin-top: 1.7rem;
    }
    .divider {
      border-top: 1.6px solid #e2e4eb;
      margin: 1.1rem 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="calculator">
      <h2>Your loan details</h2>
      <div class="tab-group">
        <button class="tab-btn active" id="currentLoanTab">Current loan</button>
        <button class="tab-btn" id="newLoanTab">New loan</button>
      </div>
      <div class="form-group">
        <div class="form-label">Home loan purpose</div>
        <div class="radio-group" id="loanPurposeGroup">
          <button class="radio-btn active" data-value="liveIn">To live in</button>
          <button class="radio-btn" data-value="investment">An investment</button>
        </div>
      </div>
      <div class="form-group">
        <div class="form-label">Repayment type</div>
        <div class="radio-group" id="repaymentTypeGroup">
          <button class="radio-btn active" data-value="principal">Principal and interest</button>
          <button class="radio-btn" data-value="interestOnly">Interest only</button>
        </div>
      </div>
      <div class="form-group form-row">
        <div style="flex:1;">
          <div class="form-label">Property value</div>
          <input type="number" id="propertyValue" min="0" step="1000" value="750000" />
        </div>
        <div style="flex:1;">
          <div class="form-label">Deposit</div>
          <input type="number" id="deposit" min="0" step="500" value="225000" />
        </div>
      </div>
      <div class="form-group form-row">
        <div style="flex:1;">
          <div class="form-label">Repayment frequency</div>
          <select id="repayFreq">
            <option value="monthly" selected>Monthly</option>
            <option value="fortnightly">Fortnightly</option>
            <option value="weekly">Weekly</option>
          </select>
        </div>
        <div style="flex:1;">
          <div class="form-label">Loan term</div>
          <select id="loanTerm">
            <option value="30" selected>30 years</option>
            <option value="25">25 years</option>
            <option value="20">20 years</option>
            <option value="15">15 years</option>
          </select>
        </div>
      </div>
      <div class="form-group form-row">
        <div style="flex:1;">
          <div class="form-label">Interest rate (%)</div>
          <input type="number" id="interestRate" min="0" max="20" step="0.01" value="5.69" />
        </div>
        <div style="flex:1;">
          <div class="form-label">Comparison rate (%)</div>
          <input type="number" id="comparisonRate" min="0" max="20" step="0.01" value="5.73" />
        </div>
      </div>
      <div class="form-group">
        <div class="form-label">Use existing Choice Package?</div>
        <select id="choicePackage">
          <option value="no" selected>No</option>
          <option value="yes">Yes</option>
        </select>
      </div>
    </div>
    <div class="results">
      <div class="result-title">Your results</div>
      <div class="result-row">
        <span class="result-label">Estimated minimum repayments</span>
        <span class="result-value" id="repayAmount">$3,044</span>
      </div>
      <div class="divider"></div>
      <div class="result-row">
        <span class="result-label">Interest rate</span>
        <span id="rateDisplay">5.69% p.a.</span>
      </div>
      <div class="result-row">
        <span class="result-label">Comparison rate</span>
        <span id="compRateDisplay">5.73% p.a.</span>
      </div>
      <div class="divider"></div>
      <div class="result-row">
        <span class="result-label">Loan amount</span>
        <span class="result-value" id="loanAmountDisplay">$525,000</span>
      </div>
      <div class="result-row">
        <span class="result-label">Interest charged</span>
        <span class="result-value" id="interestChargedDisplay">$570,759</span>
      </div>
      <div class="total-amount">
        Your estimated total amount<br>
        <span id="totalAmountDisplay">$1,095,759</span>
      </div>
    </div>
  </div>
  <script>
    function formatMoney(amount) {
      return '$' + amount.toLocaleString(undefined, {maximumFractionDigits: 0});
    }

    function calculateRepayments() {
      const propertyValue = Number(document.getElementById('propertyValue').value) || 0;
      const deposit = Number(document.getElementById('deposit').value) || 0;
      const interestRate = Number(document.getElementById('interestRate').value) || 0;
      const loanTerm = Number(document.getElementById('loanTerm').value) || 30;
      const repayFreq = document.getElementById('repayFreq').value;
      const repaymentType = document.querySelector('#repaymentTypeGroup .radio-btn.active').getAttribute('data-value');
      const compRate = Number(document.getElementById('comparisonRate').value) || interestRate;

      const loanAmount = propertyValue - deposit;
      let nPayments, periodRate;
      if(repayFreq === "monthly") {
        nPayments = loanTerm * 12;
        periodRate = interestRate / 100 / 12;
      } else if(repayFreq === "fortnightly") {
        nPayments = loanTerm * 26;
        periodRate = interestRate / 100 / 26;
      } else { // weekly
        nPayments = loanTerm * 52;
        periodRate = interestRate / 100 / 52;
      }

      let repayment = 0;
      if (repaymentType === 'interestOnly') {
        repayment = loanAmount * periodRate;
      } else {
        if (interestRate > 0) {
          const fv = Math.pow(1 + periodRate, nPayments);
          repayment = loanAmount * periodRate * fv / (fv - 1);
        }
      }

      // Total repayment and interest charged
      let totalPaid = repayment * nPayments;
      let interestCharged = totalPaid - loanAmount;

      // Display
      document.getElementById('repayAmount').textContent = formatMoney(Math.round(repayment));
      document.getElementById('loanAmountDisplay').textContent = formatMoney(loanAmount);
      document.getElementById('interestChargedDisplay').textContent = formatMoney(Math.round(interestCharged));
      document.getElementById('totalAmountDisplay').textContent = formatMoney(Math.round(totalPaid));
      document.getElementById('rateDisplay').textContent = interestRate.toFixed(2) + "% p.a.";
      document.getElementById('compRateDisplay').textContent = compRate.toFixed(2) + "% p.a.";
    }

    // Radio buttons logic
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        // tab specific logic can go here
        calculateRepayments();
      });
    });
    document.querySelectorAll('#loanPurposeGroup .radio-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('#loanPurposeGroup .radio-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        calculateRepayments();
      });
    });
    document.querySelectorAll('#repaymentTypeGroup .radio-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('#repaymentTypeGroup .radio-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        calculateRepayments();
      });
    });

    // Real-time inputs
    ['propertyValue','deposit','interestRate','comparisonRate','loanTerm','repayFreq','choicePackage'].forEach(id => {
      document.getElementById(id).addEventListener('input', calculateRepayments);
      document.getElementById(id).addEventListener('change', calculateRepayments);
    });

    // Initial calculate on page load
    calculateRepayments();
  </script>
</body>
</html>
